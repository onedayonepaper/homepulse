# HomePulse

> í™ˆ/ê°œì¸ ì¸í”„ë¼ ê´€ì œ ëŒ€ì‹œë³´ë“œ + ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ

ì§‘ì´ë‚˜ ì†Œê·œëª¨ í™˜ê²½ì˜ ë„¤íŠ¸ì›Œí¬ ì¥ë¹„(ê³µìœ ê¸°, NAS, IPì¹´ë©”ë¼, ì„œë²„ ë“±)ë¥¼ 24/7 ëª¨ë‹ˆí„°ë§í•˜ê³ , ì¥ì•  ë°œìƒ ì‹œ ì¦‰ì‹œ í…”ë ˆê·¸ë¨ìœ¼ë¡œ ì•Œë¦¼ì„ ë°›ì„ ìˆ˜ ìˆëŠ” ê²½ëŸ‰ ê´€ì œ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

![Node.js](https://img.shields.io/badge/Node.js-20+-339933?logo=node.js&logoColor=white)
![SQLite](https://img.shields.io/badge/SQLite-WAL-003B57?logo=sqlite&logoColor=white)
![Docker](https://img.shields.io/badge/Docker-Ready-2496ED?logo=docker&logoColor=white)
![License](https://img.shields.io/badge/License-MIT-blue)

---

## ì£¼ìš” ê¸°ëŠ¥

### ğŸ” ë‹¤ì¤‘ í”„ë¡œí† ì½œ í—¬ìŠ¤ì²´í¬
- **HTTP ì²´í¬**: ì›¹ ì„œë¹„ìŠ¤ ì‘ë‹µ ìƒíƒœ ì½”ë“œ ê²€ì¦
- **TCP ì²´í¬**: í¬íŠ¸ ì—°ê²° ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
- **ì‘ë‹µì‹œê°„ ì¸¡ì •**: ê° ì²´í¬ë§ˆë‹¤ ì‘ë‹µì‹œê°„(ms) ê¸°ë¡
- ì»¤ìŠ¤í…€ íƒ€ì„ì•„ì›ƒ ì„¤ì • ì§€ì›
- 60ì´ˆ ì£¼ê¸° ìë™ ì²´í¬ (ì„¤ì • ë³€ê²½ ê°€ëŠ¥)

### ğŸš¨ ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ
- **ìƒíƒœ ë³€í™” ê°ì§€**: DOWN/UP ì´ë²¤íŠ¸ë§Œ ì•Œë¦¼ (ì¤‘ë³µ ì•Œë¦¼ ë°©ì§€)
- **í…”ë ˆê·¸ë¨ ì—°ë™**: ì¦‰ì‹œ ëª¨ë°”ì¼ í‘¸ì‹œ ì•Œë¦¼
- **ì¼ì¼ ìš”ì•½ ë¦¬í¬íŠ¸**: ë§¤ì¼ ì§€ì • ì‹œê°„ì— ì „ë‚  ì¥ì•  í˜„í™© ë°œì†¡
- ì¥ì•  ë°œìƒ ì‹œê°, ë³µêµ¬ ì‹œê° í¬í•¨

### ğŸ“Š ì›¹ ëŒ€ì‹œë³´ë“œ
- ì „ì²´ ì¥ë¹„ ìƒíƒœ í•œëˆˆì— í™•ì¸ (UP/DOWN)
- ìµœê·¼ ì´ë²¤íŠ¸ ë¡œê·¸ ì¡°íšŒ
- ë§ˆì§€ë§‰ ì²´í¬ ì‹œê°„ ë° ì‘ë‹µ ë©”ì‹œì§€ í‘œì‹œ
- ë°˜ì‘í˜• UI (ëª¨ë°”ì¼ ì§€ì›)

### ğŸ“ˆ ì‘ë‹µì‹œê°„ ëª¨ë‹ˆí„°ë§
- **ì‹œê³„ì—´ ê·¸ë˜í”„**: Chart.js ê¸°ë°˜ ì‹¤ì‹œê°„ ì‘ë‹µì‹œê°„ ì¶”ì´
- **í†µê³„ ëŒ€ì‹œë³´ë“œ**: í‰ê· /ìµœëŒ€/ìµœì†Œ ì‘ë‹µì‹œê°„
- **ì¥ë¹„ë³„ ë¶„ì„**: ê°œë³„ ì¥ë¹„ ì„±ëŠ¥ ì¶”ì 
- 30ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹ 
- 7ì¼ê°„ ë°ì´í„° ë³´ê´€ (ìë™ ì •ë¦¬)

### ğŸ’¾ ìš´ì˜ ì•ˆì •ì„±
- **SQLite WAL ëª¨ë“œ**: ë™ì‹œ ì½ê¸°/ì“°ê¸° ì„±ëŠ¥ ìµœì í™”
- **ì´ë²¤íŠ¸ ë¡œê¹…**: ëª¨ë“  ìƒíƒœ ë³€í™” ì´ë ¥ ì €ì¥
- **Docker ì§€ì›**: `restart: unless-stopped`ë¡œ ìë™ ì¬ì‹œì‘
- **Graceful ì•Œë¦¼ ì‹¤íŒ¨ ì²˜ë¦¬**: ì•Œë¦¼ ì‹¤íŒ¨ê°€ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ìœ¼ë¡œ ì´ì–´ì§€ì§€ ì•ŠìŒ

---

## ìŠ¤í¬ë¦°ìƒ·

### ë©”ì¸ ëŒ€ì‹œë³´ë“œ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HomePulse                    [ğŸ“ˆ ì‘ë‹µì‹œê°„ ê·¸ë˜í”„]  â”‚
â”‚  ë¡œì»¬ ê´€ì œ(HTTP/TCP) + í…”ë ˆê·¸ë¨ ì•Œë¦¼                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ê¸°ê¸° ìƒíƒœ                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ì´ë¦„    â”‚ ìƒíƒœ   â”‚ ë§ˆì§€ë§‰ ì²´í¬  â”‚ ë©”ì‹œì§€      â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ ê³µìœ ê¸°  â”‚ âœ… UP  â”‚ 12:34:56     â”‚ TCP OK      â”‚ â”‚
â”‚  â”‚ NAS     â”‚ âœ… UP  â”‚ 12:34:56     â”‚ HTTP 200    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì‘ë‹µì‹œê°„ ê·¸ë˜í”„ (`/graph`)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ˆ ì‘ë‹µì‹œê°„ ëª¨ë‹ˆí„°ë§                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ í‰ê·      â”‚ â”‚ ìµœëŒ€     â”‚ â”‚ ìµœì†Œ     â”‚ â”‚ ì²´í¬ìˆ˜ â”‚ â”‚
â”‚  â”‚  25 ms   â”‚ â”‚  89 ms   â”‚ â”‚  12 ms   â”‚ â”‚  1440  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚  [ì‹œê³„ì—´ ê·¸ë˜í”„ - ìµœê·¼ 1ì‹œê°„ ì‘ë‹µì‹œê°„ ì¶”ì´]        â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì¼ì¼ ìš”ì•½ ì•Œë¦¼ (í…”ë ˆê·¸ë¨)
```
ğŸ“Š ì¼ì¼ ìš”ì•½ ë¦¬í¬íŠ¸
ğŸ“… 2026ë…„ 1ì›” 29ì¼

ğŸ“¡ í˜„ì¬ ìƒíƒœ: 3/3 UP (100.0%)

âœ¨ ì–´ì œ ì¥ì•  0ê±´! ì™„ë²½í•œ í•˜ë£¨ì˜€ìŠµë‹ˆë‹¤.
```

---

## ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        HomePulse                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Monitor   â”‚â”€â”€â”€â–¶â”‚   Checks    â”‚â”€â”€â”€â–¶â”‚   Notify    â”‚     â”‚
â”‚  â”‚  (Cron 60s) â”‚    â”‚ (HTTP/TCP)  â”‚    â”‚ (Telegram)  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                  â”‚                                â”‚
â”‚         â”‚                  â”‚ ì‘ë‹µì‹œê°„                       â”‚
â”‚         â–¼                  â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚     DB      â”‚â—€â”€â”€â”€â”‚   Server    â”‚â—€â”€â”€â”€ HTTP :8787        â”‚
â”‚  â”‚  (SQLite)   â”‚    â”‚  (Express)  â”‚                        â”‚
â”‚  â”‚             â”‚    â”‚  - /        â”‚                        â”‚
â”‚  â”‚ - states    â”‚    â”‚  - /graph   â”‚                        â”‚
â”‚  â”‚ - events    â”‚    â”‚  - /api/*   â”‚                        â”‚
â”‚  â”‚ - responses â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Router      â”‚  â”‚       NAS       â”‚  â”‚    IP Camera    â”‚
â”‚  192.168.0.1    â”‚  â”‚  192.168.0.10   â”‚  â”‚  192.168.0.20   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ê¸°ìˆ  ìŠ¤íƒ

| ì˜ì—­ | ê¸°ìˆ  | ì„ íƒ ì´ìœ  |
|------|------|-----------|
| Runtime | Node.js 20+ | ë¹„ë™ê¸° I/O, ë„¤íŠ¸ì›Œí¬ ì‘ì—…ì— ì í•© |
| Framework | Express | ê²½ëŸ‰ ì›¹ ì„œë²„, ë¹ ë¥¸ API êµ¬ì¶• |
| Database | SQLite (better-sqlite3) | ì„œë²„ë¦¬ìŠ¤, WAL ëª¨ë“œë¡œ ë™ì‹œì„± í™•ë³´ |
| Scheduler | setInterval | ì™¸ë¶€ ì˜ì¡´ì„± ì—†ì´ ì£¼ê¸°ì  ì‹¤í–‰ |
| Notification | Telegram Bot API | ë¬´ë£Œ, ì¦‰ì‹œ í‘¸ì‹œ, ëª¨ë°”ì¼ ì§€ì› |
| Chart | Chart.js | ê²½ëŸ‰, CDN ì‚¬ìš©, ë°˜ì‘í˜• ê·¸ë˜í”„ |
| Container | Docker + Compose | ì¼ê´€ëœ ë°°í¬ í™˜ê²½, ìë™ ì¬ì‹œì‘ |

---

## ë¹ ë¥¸ ì‹œì‘

### 1. ì €ì¥ì†Œ í´ë¡ 

```bash
git clone https://github.com/onedayonepaper/homepulse.git
cd homepulse
```

### 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
cp .env.example .env
```

`.env` íŒŒì¼ ìˆ˜ì •:
```env
PORT=8787
CHECK_INTERVAL_SEC=60

# í…”ë ˆê·¸ë¨ ì„¤ì • (ì„ íƒì‚¬í•­ - ì—†ì–´ë„ ëŒ€ì‹œë³´ë“œëŠ” ë™ì‘)
TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_CHAT_ID=your_chat_id

# ì¼ì¼ ìš”ì•½ ë°œì†¡ ì‹œê°„ (0-23, ê¸°ë³¸: 9ì‹œ)
DAILY_SUMMARY_HOUR=9
```

### 3. ëª¨ë‹ˆí„°ë§ ëŒ€ìƒ ì„¤ì •

`devices.json` ìˆ˜ì •:
```json
[
  {
    "id": "router",
    "name": "ê³µìœ ê¸°",
    "type": "tcp",
    "host": "192.168.0.1",
    "port": 80,
    "timeoutMs": 1200
  },
  {
    "id": "nas",
    "name": "Synology NAS",
    "type": "http",
    "url": "http://192.168.0.10:5000",
    "timeoutMs": 2000
  }
]
```

### 4. ì‹¤í–‰

**Docker (ê¶Œì¥)**
```bash
docker compose up -d --build
```

**ë¡œì»¬ ì‹¤í–‰**
```bash
npm install
DB_PATH=./data/homepulse.sqlite npm start
```

### 5. ì ‘ì†

| í˜ì´ì§€ | URL | ì„¤ëª… |
|--------|-----|------|
| ëŒ€ì‹œë³´ë“œ | http://localhost:8787 | ì¥ë¹„ ìƒíƒœ + ì´ë²¤íŠ¸ ë¡œê·¸ |
| ê·¸ë˜í”„ | http://localhost:8787/graph | ì‘ë‹µì‹œê°„ ì‹œê³„ì—´ ê·¸ë˜í”„ |

---

## ì„¤ì • ê°€ì´ë“œ

### devices.json ìŠ¤í‚¤ë§ˆ

| í•„ë“œ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|------|------|------|------|
| `id` | string | âœ… | ê³ ìœ  ì‹ë³„ì |
| `name` | string | âœ… | í‘œì‹œ ì´ë¦„ |
| `type` | string | âœ… | `http` ë˜ëŠ” `tcp` |
| `host` | string | TCPë§Œ | ëŒ€ìƒ í˜¸ìŠ¤íŠ¸/IP |
| `port` | number | TCPë§Œ | ëŒ€ìƒ í¬íŠ¸ |
| `url` | string | HTTPë§Œ | ì „ì²´ URL |
| `timeoutMs` | number | âŒ | íƒ€ì„ì•„ì›ƒ (ê¸°ë³¸: 1200ms) |

### í™˜ê²½ ë³€ìˆ˜

| ë³€ìˆ˜ | ê¸°ë³¸ê°’ | ì„¤ëª… |
|------|--------|------|
| `PORT` | 8787 | ì„œë²„ í¬íŠ¸ |
| `CHECK_INTERVAL_SEC` | 60 | ì²´í¬ ì£¼ê¸° (ì´ˆ) |
| `TELEGRAM_BOT_TOKEN` | - | í…”ë ˆê·¸ë¨ ë´‡ í† í° |
| `TELEGRAM_CHAT_ID` | - | í…”ë ˆê·¸ë¨ ì±„íŒ… ID |
| `DAILY_SUMMARY_HOUR` | 9 | ì¼ì¼ ìš”ì•½ ë°œì†¡ ì‹œê°„ (0-23) |
| `DB_PATH` | /data/homepulse.sqlite | SQLite DB ê²½ë¡œ |

### í…”ë ˆê·¸ë¨ ë´‡ ì„¤ì •

1. [@BotFather](https://t.me/BotFather)ì—ì„œ `/newbot` ëª…ë ¹ìœ¼ë¡œ ë´‡ ìƒì„±
2. ë°œê¸‰ë°›ì€ í† í°ì„ `TELEGRAM_BOT_TOKEN`ì— ì…ë ¥
3. ìƒì„±ëœ ë´‡ì—ê²Œ ì•„ë¬´ ë©”ì‹œì§€ë‚˜ ì „ì†¡
4. ë¸Œë¼ìš°ì €ì—ì„œ `https://api.telegram.org/bot<TOKEN>/getUpdates` ì ‘ì†
5. ì‘ë‹µì˜ `chat.id` ê°’ì„ `TELEGRAM_CHAT_ID`ì— ì…ë ¥

---

## API ëª…ì„¸

### GET /api/status

í˜„ì¬ ëª¨ë“  ì¥ë¹„ì˜ ìƒíƒœë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

**Response**
```json
{
  "devices": [
    {
      "id": "router",
      "name": "ê³µìœ ê¸°",
      "is_up": 1,
      "last_change_ts": 1706540400,
      "last_check_ts": 1706540460,
      "last_message": "TCP 192.168.0.1:80 OK"
    }
  ]
}
```

### GET /api/events

ìµœê·¼ ìƒíƒœ ë³€í™” ì´ë²¤íŠ¸ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤ (ìµœëŒ€ 50ê°œ).

**Response**
```json
{
  "events": [
    {
      "id": 1,
      "device_id": "nas",
      "device_name": "NAS",
      "type": "DOWN",
      "message": "TCP timeout",
      "ts": 1706540400
    }
  ]
}
```

### GET /api/summary

ì¼ì¼ ìš”ì•½ ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

**Response**
```json
{
  "date": "2026-01-28",
  "current": {
    "total": 3,
    "upCount": 3,
    "downCount": 0,
    "uptimePercent": "100.0"
  },
  "yesterday": {
    "downCount": 0,
    "upCount": 0,
    "deviceDownCounts": {}
  }
}
```

### POST /api/summary/send

ì¼ì¼ ìš”ì•½ì„ ì¦‰ì‹œ í…”ë ˆê·¸ë¨ìœ¼ë¡œ ë°œì†¡í•©ë‹ˆë‹¤ (í…ŒìŠ¤íŠ¸ìš©).

### GET /api/response-times

ì‘ë‹µì‹œê°„ ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

**Query Parameters**
- `limit`: ìµœëŒ€ ë°ì´í„° ê°œìˆ˜ (ê¸°ë³¸: 60, ìµœëŒ€: 1440)

**Response**
```json
{
  "router": {
    "name": "ê³µìœ ê¸°",
    "data": [
      {
        "device_id": "router",
        "response_time": 13,
        "is_up": 1,
        "ts": 1706540460
      }
    ]
  }
}
```

### GET /api/response-times/stats

ì‘ë‹µì‹œê°„ í†µê³„ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

**Query Parameters**
- `hours`: í†µê³„ ê¸°ê°„ (ê¸°ë³¸: 24, ìµœëŒ€: 168)

**Response**
```json
{
  "router": {
    "name": "ê³µìœ ê¸°",
    "avg": 15,
    "max": 89,
    "min": 12,
    "count": 1440
  }
}
```

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
homepulse/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ server.js      # Express ì„œë²„ + ëŒ€ì‹œë³´ë“œ + ê·¸ë˜í”„ í˜ì´ì§€
â”‚   â”œâ”€â”€ monitor.js     # ëª¨ë‹ˆí„°ë§ ìŠ¤ì¼€ì¤„ëŸ¬ + ì¼ì¼ ìš”ì•½ + ë°ì´í„° ì •ë¦¬
â”‚   â”œâ”€â”€ checks.js      # HTTP/TCP í—¬ìŠ¤ì²´í¬ + ì‘ë‹µì‹œê°„ ì¸¡ì •
â”‚   â”œâ”€â”€ db.js          # SQLite ìŠ¤í‚¤ë§ˆ + CRUD + í†µê³„ í•¨ìˆ˜
â”‚   â””â”€â”€ notify.js      # í…”ë ˆê·¸ë¨ ì•Œë¦¼ ì „ì†¡
â”œâ”€â”€ data/              # SQLite DB íŒŒì¼ ì €ì¥ (gitignore)
â”œâ”€â”€ devices.json       # ëª¨ë‹ˆí„°ë§ ëŒ€ìƒ ì„¤ì •
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ package.json
â”œâ”€â”€ .env.example
â””â”€â”€ .gitignore
```

---

## í•µì‹¬ êµ¬í˜„ í¬ì¸íŠ¸

### 1. ìƒíƒœ ë³€í™” ê°ì§€ ë¡œì§

```javascript
// monitor.js
const changed = prevUp === null || prevUp !== isUp;

if (changed) {
  // ì´ë²¤íŠ¸ ê¸°ë¡ + ì•Œë¦¼ ë°œì†¡
  // ë™ì¼ ìƒíƒœ ìœ ì§€ ì‹œì—ëŠ” ì•Œë¦¼í•˜ì§€ ì•ŠìŒ (ì•Œë¦¼ í”¼ë¡œ ë°©ì§€)
}
```

### 2. ì‘ë‹µì‹œê°„ ì¸¡ì •

```javascript
// checks.js
const startTime = Date.now();
const r = await fetch(url, { signal: controller.signal });
const responseTime = Date.now() - startTime;
return { ok: r.ok, message: `HTTP ${r.status}`, responseTime };
```

### 3. ì¼ì¼ ìš”ì•½ ìŠ¤ì¼€ì¤„ëŸ¬

```javascript
// monitor.js
function scheduleNext() {
  const next = new Date();
  next.setHours(summaryHour, 0, 0, 0);
  if (next <= now) next.setDate(next.getDate() + 1);

  setTimeout(() => {
    sendDailySummary();
    setInterval(sendDailySummary, 24 * 60 * 60 * 1000);
  }, next - now);
}
```

### 4. ë°ì´í„° ìë™ ì •ë¦¬

```javascript
// db.js
export function cleanupResponseTimes(db, daysToKeep = 7) {
  const cutoffTs = Math.floor(Date.now() / 1000) - (daysToKeep * 24 * 3600);
  return db.prepare(`DELETE FROM response_times WHERE ts < ?`).run(cutoffTs);
}
```

### 5. SQLite WAL ëª¨ë“œ

```javascript
// db.js
db.exec(`PRAGMA journal_mode = WAL;`);
// ì½ê¸°/ì“°ê¸° ë™ì‹œ ìˆ˜í–‰ ê°€ëŠ¥, í¬ë˜ì‹œ ë³µêµ¬ í–¥ìƒ
```

---

## ìš´ì˜ ê°€ì´ë“œ

### ë¡œê·¸ í™•ì¸
```bash
docker logs -f homepulse
```

### ì¥ë¹„ ì¶”ê°€/ìˆ˜ì •
1. `devices.json` ìˆ˜ì •
2. ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘: `docker compose restart`

### ë°ì´í„° ë°±ì—…
```bash
cp ./data/homepulse.sqlite ./backup/
```

### ëª¨ë‹ˆí„°ë§ ì£¼ê¸° ë³€ê²½
`.env`ì—ì„œ `CHECK_INTERVAL_SEC` ê°’ ìˆ˜ì • í›„ ì¬ì‹œì‘

### ì¼ì¼ ìš”ì•½ í…ŒìŠ¤íŠ¸
```bash
curl -X POST http://localhost:8787/api/summary/send
```

---

## í™•ì¥ ì•„ì´ë””ì–´

- [x] ~~ì¼ì¼ ìš”ì•½ ë¦¬í¬íŠ¸ ë°œì†¡~~
- [x] ~~ì‘ë‹µ ì‹œê°„ ê·¸ë˜í”„ (ì‹œê³„ì—´ ë°ì´í„°)~~
- [ ] ICMP Ping ì²´í¬ ì¶”ê°€
- [ ] ìŠ¬ë™/ë””ìŠ¤ì½”ë“œ ì•Œë¦¼ ì—°ë™
- [ ] ë‹¤ì¤‘ ì‚¬ìš©ì ì§€ì› + ì¸ì¦
- [ ] Prometheus ë©”íŠ¸ë¦­ ì—”ë“œí¬ì¸íŠ¸
- [ ] GitHub Actions CI/CD

---

## ë¼ì´ì„ ìŠ¤

MIT License

---

## ê¸°ì—¬

ì´ìŠˆì™€ PRì„ í™˜ì˜í•©ë‹ˆë‹¤.
